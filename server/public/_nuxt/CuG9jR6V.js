import{bu as d,H as $,E as h}from"./Cr5Ubhxi.js";import{E as j}from"./lylAQj0-.js";import{E as H,a as L}from"./Dua6tcUZ.js";import{E as P,a as Z}from"./DSuzuHr1.js";import{E as q}from"./BruNbhwZ.js";import{E as A}from"./BpShNd2i.js";import{E as G}from"./DuE7aCnB.js";import{E as J}from"./C-cM_-N0.js";import{_ as K}from"./CGGYEFhd.js";import{E as Q}from"./Cp1klw-J.js";import"./l0sNRNKZ.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./DP2rzg_V.js";/* empty css        *//* empty css        *//* empty css        */import{l as W,b as w,r as y,m as X,M as b,a0 as z,a1 as o,a6 as l,O as a,ag as i,a3 as p,u,N as Y,ao as ee,_ as le,Z as te}from"./BgewwvAi.js";const oe={class:"flex items-center"},se={class:"flex items-center"},ae={class:"flex items-center"},ne={class:"flex items-center"},ie={class:"flex items-center"},me={class:"flex items-center"},re={class:"flex items-center"},de={class:"flex items-center"},pe={class:"flex items-center"},ue={class:"flex justify-center pt-3"},De=W({__name:"test-params",props:{visible:{type:Boolean},default:{}},emits:["confirm","cancel"],setup(S,{emit:B}){const k=S,V=B,v=w(k.visible),x=w(),s=y({search_mode:"similar",search_similar:0,search_tokens:8e3,optimize_ask:0,optimize_m_id:"",optimize_s_id:"",ranking_status:0,ranking_score:0,ranking_model:"",...k.default}),N=X(()=>s.search_mode==="similar"),C=y({}),F=[{label:"混合检索",value:"mix"},{label:"语义检索",value:"similar"},{label:"全文检索",value:"full"}],M=async _=>{_&&await _.validate(t=>{t&&V("confirm",s)})};return(_,t)=>{const m=$,r=j,D=H,I=L,n=P,c=q,f=A,E=G,g=J,U=K,O=h,T=Z,R=Q;return b(),z(R,{modelValue:v.value,"onUpdate:modelValue":t[13]||(t[13]=e=>v.value=e),title:"知识库检索配置",width:"620","append-to-body":!0,"close-on-click-modal":!1,onClosed:t[14]||(t[14]=e=>V("cancel"))},{default:o(()=>[l(T,{ref_key:"formRef",ref:x,model:s,rules:C,"label-width":"110","label-position":"left","status-icon":""},{default:o(()=>[l(n,{label:"检索模式",prop:"search_mode"},{label:o(({label:e})=>[a("span",oe,[i(p(e)+" ",1),l(r,{placement:"top"},{content:o(()=>t[15]||(t[15]=[a("p",null,"语义检索: 采用向量化模型进行向量检索",-1),a("p",null,"全文检索: 使用传统的数据库检索方式检索",-1),a("p",null,"混合检索: 语义检索+全文检索,具有更好的效果,建议搭配重排模型使用。",-1),a("p",null,"注意: 当您使用全文或混合检索时，是没有语义相似度的，建议您开启重排模型",-1)])),default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[l(I,{class:"!w-64",modelValue:s.search_mode,"onUpdate:modelValue":t[0]||(t[0]=e=>s.search_mode=e),placeholder:"请选择搜索模式"},{default:o(()=>[(b(),Y(le,null,ee(F,e=>l(D,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"引用上限",prop:"search_tokens"},{label:o(({label:e})=>[a("span",se,[i(p(e)+" ",1),l(r,{placement:"top"},{content:o(()=>t[16]||(t[16]=[a("p",null,"该参数表示单次文档从知识库检索最大的Tokens数量",-1),a("p",null,"说明: 引用越多意味着所需消耗的token越多",-1),a("p",null,"注意: 切记不要超出模型的最大token限制",-1)])),default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[a("div",ae,[l(c,{class:"!w-64",modelValue:s.search_tokens,"onUpdate:modelValue":t[1]||(t[1]=e=>s.search_tokens=e),min:100,max:3e4},null,8,["modelValue"]),l(f,{class:"ml-4",modelValue:s.search_tokens,"onUpdate:modelValue":t[2]||(t[2]=e=>s.search_tokens=e),min:100,max:3e4},null,8,["modelValue"])])]),_:1}),N.value?(b(),z(n,{key:0,label:"最低相似度",prop:"search_similar"},{label:o(({label:e})=>[a("span",ne,[i(p(e)+" ",1),l(r,{placement:"top"},{content:o(()=>t[17]||(t[17]=[a("p",null,"语义检索的精度，提问检索的内容需要达到该精度才会被引用",-1),a("ol",{class:"list-decimal pl-4"},[a("li",null,"高语义相似度(>=0.8): 会检索相关性高的知识，会更准确，同时也容易未命中。"),a("li",null,"低语义相似度(如0.4): 检索范围更大，更容易匹配知识，但可能回答会不准确。"),a("li",null,"不同的向量模型检索相似度不一样，具体情况到 『知识库 - 搜索测试』进行调试。"),a("li",null,"如果您使用的是『全文检索/混合检索』这个值则不会生效，仅对语义检索有效。")],-1)])),default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[a("div",ie,[l(c,{class:"!w-64",modelValue:s.search_similar,"onUpdate:modelValue":t[3]||(t[3]=e=>s.search_similar=e),size:"small",min:0,max:1,step:.001,disabled:s.search_mode!=="similar"},null,8,["modelValue","disabled"]),l(f,{class:"ml-4",modelValue:s.search_similar,"onUpdate:modelValue":t[4]||(t[4]=e=>s.search_similar=e),min:0,max:1,step:.001,disabled:s.search_mode!=="similar"},null,8,["modelValue","disabled"])])]),_:1})):te("",!0),l(E),l(n,{label:"结果重排",prop:"ranking_status"},{label:o(({label:e})=>[a("span",me,[i(p(e)+" ",1),l(r,{content:"使用重排模型来进行二次排序, 可增强综合排名。",placement:"top"},{default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[l(g,{modelValue:s.ranking_status,"onUpdate:modelValue":t[5]||(t[5]=e=>s.ranking_status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(n,{label:"重排权重",prop:"ranking_score"},{label:o(({label:e})=>[a("span",re,[i(p(e)+" ",1),l(r,{content:"低于这个分数的数据将会被过滤。",placement:"top"},{default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[a("div",de,[l(c,{class:"!w-64",modelValue:s.ranking_score,"onUpdate:modelValue":t[6]||(t[6]=e=>s.ranking_score=e),min:0,max:1,step:.001},null,8,["modelValue"]),l(f,{class:"ml-4",modelValue:s.ranking_score,"onUpdate:modelValue":t[7]||(t[7]=e=>s.ranking_score=e),min:0,max:1,step:.001},null,8,["modelValue"])])]),_:1}),l(n,{label:"重排模型",prop:"ranking_model"},{default:o(()=>[l(U,{class:"!w-64",id:s.ranking_model,"onUpdate:id":t[8]||(t[8]=e=>s.ranking_model=e),"set-default":!1,type:"rankingModels",disabled:!1},null,8,["id"])]),_:1}),l(E),l(n,{label:"问题优化",prop:"optimize_ask"},{label:o(({label:e})=>[a("span",pe,[i(p(e)+" ",1),l(r,{content:"综合历史记录和问题, 多维度的生成相似问题, 可增加知识库检索时的精准度。",placement:"top"},{default:o(()=>[l(m,{class:"ml-1 cursor-pointer"},{default:o(()=>[l(u(d))]),_:1})]),_:1})])]),default:o(()=>[l(g,{modelValue:s.optimize_ask,"onUpdate:modelValue":t[9]||(t[9]=e=>s.optimize_ask=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(n,{label:"优化模型",prop:"optimize_m_id"},{default:o(()=>[l(U,{class:"!w-64",id:s.optimize_m_id,"onUpdate:id":t[10]||(t[10]=e=>s.optimize_m_id=e),sub_id:s.optimize_s_id,"onUpdate:sub_id":t[11]||(t[11]=e=>s.optimize_s_id=e),"set-default":!1,type:"chatModels",disabled:!1},null,8,["id","sub_id"])]),_:1}),a("div",ue,[l(O,{type:"primary",onClick:t[12]||(t[12]=e=>M(x.value))},{default:o(()=>t[18]||(t[18]=[i("确认")])),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});export{De as _};
