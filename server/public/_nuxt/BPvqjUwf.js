import{j as Z,l as G,cX as H,f as C,cY as J,cM as K,bx as Q,E as R,e as W,v as ee}from"./Cr5Ubhxi.js";import{_ as te}from"./BBYJlS94.js";import{_ as oe}from"./CyY3lptK.js";import{a as se,E as ne}from"./Bt5v7KW9.js";import{a as ae,_ as ie}from"./CwafHyED.js";import{E as le}from"./DJju3RTy.js";import{_ as re}from"./Bw3YIGRg.js";import{E as de}from"./B-UECF4z.js";/* empty css        *//* empty css        *//* empty css        */import"./l0sNRNKZ.js";/* empty css        *//* empty css        */import{u as me}from"./DqVQeDvA.js";import{a as pe}from"./CiYvFM4x.js";import{l as ce,r as T,b as _e,ai as ue,c as fe,k as he,M as l,N as _,a6 as o,a1 as s,u as n,O as a,a3 as u,ag as m,a7 as ge,a0 as f,Z as v,_ as ke,y as ve,n as ye}from"./BgewwvAi.js";import"./DlAUqK2U.js";import"./lylAQj0-.js";import"./DCTLXrZ8.js";import"./BxqZsOx6.js";import"./CvX1p1Zl.js";import"./lURfvm38.js";import"./DkD6xkHx.js";import"./CLdqNFDZ.js";import"./CthRtmCg.js";import"./DLQfD3Uz.js";import"./Ca-AvAta.js";import"./BN2uy5AJ.js";/* empty css        */import"./BLukb3GJ.js";import"./CdGbKsdt.js";import"./Cpg3PDWZ.js";import"./Cp1klw-J.js";import"./vqJmiX2Z.js";/* empty css        */import"./BqlgzoPF.js";import"./Dua6tcUZ.js";import"./WwjzPWiF.js";import"./B8eVAIGV.js";import"./HhgPgBuu.js";/* empty css        */const xe={class:"h-full"},be={class:"p-main"},Ce={class:"bg-white rounded-lg p-[20px]"},Ve={class:"border-b border-solid border-br-light pb-[10px]"},we={class:"text-tx-secondary ml-[10px]"},Ee={class:"py-main"},$e={class:"flex items-center flex-wrap"},Se={class:"flex-1"},Be=["href"],Re={class:"flex-none flex"},Te={class:"flex-1 min-h-0"},De={class:"flex items-center"},Fe={class:"ml-2"},Ne={key:0},Ue={key:1,class:"text-warning"},Ie={key:2,class:"text-success"},Le=["onClick"],Pe=["href"],Me={class:"flex justify-end mt-4"},Bt=ce({__name:"video_compositing",async setup(je){let V,w;const E=Z();G();const h=T({show:!1,url:""}),y=T({keyword:""}),{pager:r,getLists:p,resetPage:D}=me({fetchFun:H,params:y}),x=_e([]),F=i=>{x.value=i.map(t=>t.id)},$=async i=>{await C.confirm("确定要删除？"),await J({ids:i}),p()},N=async(i,t)=>{const{value:g}=await C.prompt("修改视频名称","",{inputValue:t});await K({name:g,id:i}),p()},U=Q(()=>{D()},1e3),I=i=>{C.confirm(`错误信息：${i}`,"失败原因",{showConfirmButton:!1,type:"error",cancelButtonText:"关闭"})},L=async i=>{h.show=!0,await ye(),h.url=i},P=(i,t)=>{pe(i,t)};[V,w]=ue(()=>p()),await V,w();let b=null;return fe(()=>r.extend,i=>{i.unfinished_num>0?b=setTimeout(()=>{p()},30*1e3):E.getUser()},{immediate:!0}),he(()=>{b&&clearTimeout(b)}),(i,t)=>{const g=R,S=te,B=oe,k=R,M=W,d=se,j=ie,z=le,q=ne,A=re,O=de,X=ae,Y=ee;return l(),_("div",xe,[o(O,null,{default:s(()=>[a("div",be,[a("div",Ce,[a("div",Ve,[t[4]||(t[4]=a("span",{class:"text-2xl font-medium"},"视频合成",-1)),a("span",we," 剩余合成时长："+u(n(E).userInfo.video_num)+"分钟 ",1)]),a("div",Ee,[a("div",$e,[a("div",Se,[o(S,{custom:"",to:"/digital_human/design"},{default:s(({href:e})=>[a("a",{href:e,class:"mr-[10px]",target:"_blank"},[o(g,{type:"primary"},{default:s(()=>t[5]||(t[5]=[m("新建视频")])),_:1})],8,Be)]),_:1}),o(g,{disabled:!n(x).length,onClick:t[0]||(t[0]=e=>$(n(x)))},{default:s(()=>t[6]||(t[6]=[m("批量删除")])),_:1},8,["disabled"])]),a("div",Re,[o(M,{modelValue:n(y).keyword,"onUpdate:modelValue":t[1]||(t[1]=e=>n(y).keyword=e),placeholder:"搜索",onInput:n(U)},{prepend:s(()=>[o(k,{loading:n(r).loading},{icon:s(()=>[o(B,{name:"el-icon-Search"})]),_:1},8,["loading"])]),_:1},8,["modelValue","onInput"]),o(g,{circle:"",plain:"",class:"ml-[10px]",onClick:n(p)},{icon:s(()=>[o(B,{name:"el-icon-Refresh"})]),_:1},8,["onClick"])])])]),a("div",Te,[ge((l(),f(q,{height:"100%",size:"large",data:n(r).lists,onSelectionChange:F},{default:s(()=>[o(d,{type:"selection",width:"55"}),o(d,{label:"文件名称","min-width":"200"},{default:s(({row:e})=>[a("div",De,[e.video_url?(l(),f(j,{key:0,onClick:c=>L(e.video_url),class:"cursor-pointer",type:"video","file-size":"70px",uri:e.video_url},null,8,["onClick","uri"])):v("",!0),a("div",Fe,u(e.name),1)])]),_:1}),o(d,{label:"生成进度","min-width":"200"},{default:s(({row:e})=>[e.status!==1?(l(),f(z,{key:0,percentage:e.synthetic_schedule},null,8,["percentage"])):(l(),_(ke,{key:1},[m("-")],64))]),_:1}),o(d,{label:"任务状态","min-width":"120"},{default:s(({row:e})=>[e.status==1?(l(),_("span",Ne,u(e.status_desc),1)):e.status==2?(l(),_("span",Ue,u(e.status_desc),1)):e.status==3?(l(),_("span",Ie,u(e.status_desc),1)):(l(),_("span",{key:3,class:"text-error cursor-pointer",onClick:c=>I(e.fail_reason)},u(e.status_desc),9,Le))]),_:1}),o(d,{label:"消耗时长",prop:"consume_time","min-width":"120"}),o(d,{label:"最后更新时间",prop:"update_time","min-width":"180","show-tooltip-when-overflow":""}),o(d,{label:"操作",width:"180",fixed:"right"},{default:s(({row:e})=>[e.status==3&&e.video_url?(l(),f(k,{key:0,type:"primary",link:"",onClick:c=>P(e.video_url,e.name)},{default:s(()=>t[7]||(t[7]=[m(" 下载 ")])),_:2},1032,["onClick"])):v("",!0),e.status==1||e.status==4?(l(),f(S,{key:1,custom:"",to:`/digital_human/design?id=${e.id}`},{default:s(({href:c})=>[a("a",{href:c,class:"mr-[10px]",target:"_blank"},[o(k,{type:"primary",link:""},{default:s(()=>t[8]||(t[8]=[m(" 编辑 ")])),_:1})],8,Pe)]),_:2},1032,["to"])):v("",!0),o(k,{type:"primary",link:"",onClick:c=>N(e.id,e.name)},{default:s(()=>t[9]||(t[9]=[m(" 重命名 ")])),_:2},1032,["onClick"]),e.delete_btn?(l(),f(k,{key:2,type:"danger",link:"",onClick:c=>$([e.id])},{default:s(()=>t[10]||(t[10]=[m(" 删除 ")])),_:2},1032,["onClick"])):v("",!0)]),_:1})]),_:1},8,["data"])),[[Y,n(r).loading]])]),a("div",Me,[o(A,{modelValue:n(r),"onUpdate:modelValue":t[2]||(t[2]=e=>ve(r)?r.value=e:null),onChange:n(p)},null,8,["modelValue","onChange"])])])])]),_:1}),o(X,{modelValue:n(h).show,"onUpdate:modelValue":t[3]||(t[3]=e=>n(h).show=e),url:n(h).url,type:"video"},null,8,["modelValue","url"])])}}});export{Bt as default};
